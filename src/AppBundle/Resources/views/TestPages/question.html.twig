{% extends '::base.html.twig' %}

{% set charArray = {1 : 'A', 2 : 'B', 3 : 'C', 4 : 'D', 5 : 'E', 6 : 'F', 7 : 'G'} %}

{% block body %}
    {% for group in app.session.get('questionGroups') %}
        {% if not group[0].book.title %}
            <b>{{ loop.index ~ '. PHP Test' }}</b><br>
        {% else %}
            <b>{{ loop.index }}.{{ group[0].book.title }}</b><br>
        {% endif %}
        {% for question in group %}
            {% if question.id == current.id %}
                <b><a title="{{ question.title }}"
                      href="{{ path('question', {'id': question.id }) }}">{{ loop.index }}</a></b>
            {% else %}
                <a title="{{ question.title }}" href="{{ path('question', {'id': question.id }) }}">{{ loop.index }}</a>
            {% endif %}
        {% endfor %}<br>
    {% endfor %}

    <div id="countdown">
        <p class="hours">00</p>
        <p class="minutes">00</p>
        <p class="seconds">00</p>
    </div>

    {{ form_start(form) }}
    {{ index ~ '.' }}{{ current.content|raw }}

    {% for answer in form.answers %}
        <div class="alert">
            {{ charArray[loop.index] }}{{ form_widget(answer) }}
            {{ form_label(answer)|replace({"&lt;" : "<", "&gt;" : ">", "&amp;" : "&"})|raw }}
        </div>
    {% endfor %}

    {{ form_widget(form.previous) }}
    {{ form_widget(form.next) }}
    {{ form_end(form) }}
    <input type="button" id="solve" value="Solve it">
{% endblock %}
{% block javascripts %}
    <script src="{{ asset('js/script.js') }}"></script>

    <script type="text/javascript">

        $("#countdown").countdown({
            date: "{{ app.session.get('endsAt')|date('Y/m/d/H:i:s') }}",
            format: "on"
        });
        sendAnswers("input[name^='test_question[answers]']", '{{ path('questionChosen') }}', '{{ current.id }}');
        solveQuestion($('#solve'), '{{ path('solveIt') }}', '{{ current.id }}', $('.alert input'));

    </script>
{% endblock %}